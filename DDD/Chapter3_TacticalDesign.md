# 领域驱动战术设计

领域驱动战术设计，是一组技术资源用于构建域模型，这些资源必须应用于在单个边界上下文中工作。当战术设计标准使用正确时，您实际上可以丰富您的域模型，因此这将清晰地反映您的业务。战术设计帮助我们使用构建基块创建优雅的域模型，同是也送领域驱动的设计的角度展示了面向对象设计的最佳实践。它们指导决策，以澄清模型并使模型和实现保持一致，相互加强对方的有效性。精心设计各个模型元素的细节为开发人员提供了一个稳定的平台，从中可以探索模型并使它们与实现保持密切的对应关系。


## 领域建模构造块

![Build Block](https://github.com/stonenice/articles/blob/main/DDD/images/building-block.png)

### 分层架构：Layered Architecture
### 模块：Module
### 领域服务: Service
### 实体: Entity
### 值对象：Value Object
### 聚合: Aggregate
### 持久化仓储: Repository
### 工厂： Factory 

## 聚合:Aggregate
聚合代表一种高度紧密的关系，通常可以通过以下几种方法来设计界上下文中这些高度聚合的紧密关系：
1） 改变主谓宾顺序
2） 根据领域事件
3） 单一职责行为
4） 通过事务边界
5） 按时间边界

通过事件风暴已经对领域空间进行了初步的划界并确认了有界上下文，下一步便是在有界上下文中找到聚合。


### 聚合设计的方法论

#### 改变主谓宾顺序

#### 根据领域事件

#### 单一职责行为
聚合的逻辑一致不但表现在紧凑的结构关系上，还表现在高度一致、高度凝聚的职责行为上，从职责行为的角度可以看到聚合模型的特征：信息拥有者(协作者)模型、决策控制者模型。


#### 通过事务边界

#### 按时间边界

### 奥卡姆剃刀原理
奥卡姆剃刀定律（Occam's Razor, Ockham's Razor）又称“奥康的剃刀”，它是由14世纪英格兰的逻辑学家、圣方济各会修士奥卡姆的威廉（William of Occam，约1285年至1349年）提出。这个原理称为“如无必要，勿增实体”，即“简单有效原理”。正如他在《箴言书注》2卷15题说“切勿浪费较多东西去做，用较少的东西，同样可以做好的事情。

根据奥卡姆剃刀原理，如无必要，勿增实体。如电商系统中的订单和交易都能够表示用户订购商品的概念，但是交易的概念隐含着一手交钱和一手交货的意思，也就是说在订单有界上下文中需要关系支付和发货的概念。和订单聚合根相比，用交易作为聚合根聚合得太大了。所以在订单聚合能表达用户订单的含义时没有必要再进一步的深度抽象。否则容易抽象出上帝对象来，如果思维中没有一个否定上帝的思维习惯，那么就总会不自觉尽情发挥抽象思维，直到天人合一，这种抽象思维反而会将简单事情复杂化。

适时应用奥卡姆剃刀原理能帮助控制聚合根的大小，那么如何判断聚合根设计得大了还是小了呢？简单得方法是判断聚合根得树形结构是否到达三层或三层以上，如果是就不是简单得树形结构了，虽然把问题空间变得得内部有序，但是带来了结构得复杂性。


## 实体：Entity
什么是领域驱动设计中实体？可以简单的理解为：DDD实体=唯一标识+业务行为方法，拥有业务行为方法的对象模型是充血模型，因此DDD实体也是一种充血模型。拥有唯一标识是实体的主要特征，因此可以用是否应该具有唯一标识来识别DDD中的实体。

## 值对象:Value Object

## 领域服务：Service
领域服务的定义是：无法放入实体和值对象的行为操作，或者涉及多个实体的协同操作都可以放入领域服务中，因为放入任何一个对象都较难体现聚合特性。


